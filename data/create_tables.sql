BEGIN;

DROP TABLE IF EXISTS "user", "quiz", "quiz_and_theme_link", "theme", "question", "level", "proposal";

CREATE TABLE "user" (
id INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
firstname VARCHAR(50)  NOT NULL,
lastname VARCHAR(50)  NOT NULL,
email VARCHAR(255) UNIQUE NOT NULL,
password VARCHAR(255) NOT NULL
);

CREATE TABLE "theme" (
id INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
name TEXT NOT NULL
);

CREATE TABLE "level" (
id INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
name TEXT UNIQUE NOT NULL
);

CREATE TABLE "quiz" (
id INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
title TEXT NOT NULL,
description TEXT NOT NULL,
author_id INTEGER REFERENCES "user"(id)
);

CREATE TABLE "question" (
id INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
description TEXT NOT NULL,
wiki TEXT NOT NULL,
anecdote TEXT NOT NULL,
level_id INTEGER REFERENCES level(id),
quiz_id INTEGER REFERENCES quiz(id)
);

CREATE TABLE "proposal" (
id INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
description TEXT NOT NULL,
question_id INTEGER REFERENCES question(id)
);

CREATE TABLE "quiz_and_theme_link" (
id INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
quiz_id INTEGER REFERENCES quiz(id),
theme_id INTEGER REFERENCES theme(id)
);

COMMIT;